function frameInit(e) { if (typeof frameSettings.isInit != "undefined" && frameSettings.isInit) return; if (!frameSettings.autoInit) { if (!e) return; if (e == jQuery) return } var t = document.documentElement, n = t.clientWidth, r = t.clientHeight; $("#ie6").length == 0 ? frame_init(n, r, t) : ie6_init(n, r, t), frameSettings.isInit = !0 } function frame_init(e, t, n) { var r = e, i = t, s = $("#content"), o = $("#contentNav"), u = $("#contentBody"), a = $(".content", u), f = $("#main"), l = $("#sidebar"), c, h, p, d, v = $(".title", f).height(), m = frameSettings.mainMinHeight; m = m >= 0 ? m : v; var g = l.width(), y = l.outerWidth(!0), b = y - g, w = l.outerHeight(!0) - l.height(), E, S, x, T, N, C, k, L, A = $("#tips"), O = $(".tips", A), M = O.width(), _ = 10, D = $(".draggle", A), P = A.length != 0, H = frameSettings.tipsMinWidth; H = H >= 0 ? H : M, P ? A.css("display") != "block" ? A.data("isHidden", "1") : $(".quickbar .note", f).hide() : $(".quickbar .note", f).hide(), r -= u.outerWidth(!0) - u.width(), i -= s.outerHeight(!0) - s.height(), i -= o.outerHeight(!0), i -= u.outerHeight(!0) - u.height(), h = r - y; var B = 2 + _, j, F = .382, I = M / (h - B), q = function () { u.css("visibility", "hidden"), u.width(0), u.height(0); var s = [e - n.clientWidth, t - n.clientHeight]; e -= s[0], t -= s[1], r -= s[0], i -= s[1], h -= s[0]; var o = h, f = E.css("display") != "block", l = E.data("isHide"), v = A.data("isHidden"), y = M; P && !v && (o -= y + _), !C || f ? (d = 0, p = i - 2) : l ? (d = L, p = i - d - j) : p <= m ? (p = m, d = i - p - j) : (d = Math.floor((i - j) * F), p = i - d - j), u.width(r), u.height(i), c = i - 2, sidebar_resize(g, c), a.width(o), C && detail_resize(o - 2, d), main_resize(o - 2, p), A.width(y + _), tips_resize(y, c), u.css("visibility", "visible") }; if (P) { var R = function (e) { var t = $(document.body); t[0].setCapture ? t[0].setCapture() : e.preventDefault(); var n = e.screenX, r = h - M - _, i = r, s = M, o = 200, u = function (e) { var t = parseInt(e.screenX - n); i = r + t, s = M - t, s <= 0 ? (i = r + M, s = 0) : i <= o && (i = o, s = M + r - o), A.width(s + _), tips_resize(s, c), a.width(i), document.selection ? document.selection.empty() : window.getSelection().removeAllRanges() }, f = function (e) { t.removeClass("drag2"), D.removeClass("click"), t.unbind("mouseup", f), t.unbind("mousemove", u), t[0].releaseCapture && t[0].releaseCapture(); if (s != M) { var n = $("#main .quickbar .note"); s != 0 ? (M = s, I = M / (h - B)) : n.click() } }; t.bind("mousemove", u), t.bind("mouseup", f), t.addClass("drag2"), D.addClass("click") }; D.mousedown(R) } var U = function () { E = $("#detail"), S = $(".title", E).height(), x = $(".draggle", a), T = $(".title .btn_hide", E), N = x.height(), C = E.length != 0, k = T.length != 0 && T.css("display") != "none", L = frameSettings.detailMinHeight, L = L >= 0 ? L : S, E.data("isHide", ""); if (C) { E.css("display") != "block" ? x.hide() : k && E.hasClass("detail-hide") && E.data("isHide", "1"), j = 4 + N; var e = function (e) { var t = $(document.body); t[0].setCapture ? t[0].setCapture() : e.preventDefault(); var n = e.screenY, r = p, s = d, o = function (e) { var t = parseInt(e.screenY - n); r = p + t, s = d - t, s < L ? (s = L, r = i - s - j) : r < m && (r = m, s = i - r - j), detail_resize(h, s), main_resize(h - 2, r), document.selection ? document.selection.empty() : window.getSelection().removeAllRanges() }, u = function (e) { t.removeClass("drag"), x.removeClass("click"), t.unbind("mouseup", u), t.unbind("mousemove", o), t[0].releaseCapture && t[0].releaseCapture(); if (s != d) { var n = $(".btn_hide", E); !k || s != L ? (p = r, d = s, F = s / (i - j), E.data("isHide") && n.click()) : n.click() } }; t.bind("mousemove", o), t.bind("mouseup", u), t.addClass("drag"), x.addClass("click") }; x.mousedown(e), detail_init() } q() }; sidebar_init(), main_init(), U(), $(window).resize(q), main_reinit(U), quickbar_init() } function quickbar_init(e) { var t = jq.$.div, n = $("#contentNav"); if (e) return; var r = $(".nav", n), i = 106, s = 30, o = $("ul", r), u = $("<span>").addClass("a"), a = $("<div>").append(t("m_l")).append(t("m_l").addClass("m_r")).append(t("m_c")), f = a.clone().addClass("m_t"), l = a.clone().addClass("m_b"), c = a.clone().addClass("m_m"), h = $("<table>").append($("<tr>").append($("<td>"))); $("li", o).each(function (e, t) { var n = $(t), r = h.clone(), o = $("td", r); if (e == 0) { var a = $(".item", n), p = $(".layer", n), d = c.clone(); o.append($("> *", a)), o.append(u.clone()), $(".m_c", d).append(r), a.append(d); var v = r.width() + s; n.width(v); var m = v < i ? i : v; p.width(m); var g = c.clone(); $(".m_c", g).append($("> *", p)).addClass("noHideBlockTextLink"), p.append(f.clone()).append(g).append(l.clone()) } else { var v = $("a", n).outerWidth(!0); n.width(v) } }), r.css({ visibility: "visible" }), o.width(o.width() + 1); var p = $("li:first-child", r), d = $("td > .i", p), v = d.css("display") == "block"; window.showMessageNumber = function (e) { d.text(e), v || (d.show(), p.width(p.width() + 31), o.width(o.width() + 31), v = !0) }, window.hideMessageNumber = function () { d.text(), v && (d.hide(), p.width(p.width() - 31), o.width(o.width() - 31), v = !1) }; var m = $(".layer .menu_support", r), g = $("a > span", m), y = g.css("display") == "inline"; y && m.addClass("strong"), window.showSupportNumber = function (e) { g.text("(" + e + ")"), y || (g.show(), m.addClass("strong"), y = !0) }, window.hideSupportNumber = function () { g.text(), y && (g.hide(), m.removeClass("strong"), y = !1) } } function main_init() { var e = $(document.body), t = $("#main"), n = $(".quickbar", t), r = $(".note", n); tips_init(r), $(".btns .btn", n).each(function (e, t) { var n = $(t); t.className.indexOf("icon-") != -1 && n.addClass("icon"), n.wrapInner($("<div>")), $("> div", n).prepend($("<span>")) }) } function main_reinit(e) { window.main_reinit = function () { var t = $(document.body), n = $("#main"), r = $(".quickbar", n), i = $(".note", r); i.click(function () { $("#tips .btn_close").click() }), $(".btns .btn", r).each(function (e, t) { var n = $(t); t.className.indexOf("icon-") != -1 && !n.hasClass("icon") && (n.addClass("icon"), n.wrapInner($("<div>")), $("> div", n).prepend($("<span>"))) }), e() } } function main_resize(e, t) { var n = $("#main"), r = $(".title", n), i = $(".quickbar", n), s = $(".mainContent", n), o = i.length != 0; o && i.css("display") != "block" && (o = !1); var u = o ? i.outerHeight(!0) : 0, a = t - r.outerHeight(!0) - u; n.height(t), s.height(a), typeof frameSettings.mainResize == "function" && frameSettings.mainResize(e, a, s) } function detail_init() { var e = $("#detail"), t = $(".title .btn_hide", e), n = t.length != 0 && t.css("display") != "none", r = n && e.hasClass("detail-hide"), i = function () { e.toggleClass("detail-hide"), r = !r, e.data("isHide", r ? "1" : ""), $(window).resize() }; $(".title", e).dblclick(function () { i(), document.selection && document.selection.empty && (document.selection.empty(), 1) || window.getSelection && window.getSelection().removeAllRanges() }), $(".btn_hide", e).click(i); var s = $(".navs .items", e); s.each(function (e, t) { var n = $(t); n.click(function () { s.removeClass("current"), n.addClass("current") }) }) } function detail_resize(e, t) { var n = $("#detail"), r = $(".title", n), i = $(".detailNav", n), s = $(".detailContent", n), o = i.length != 0; o && i.css("display") != "block" && (o = !1); var u = o ? i.outerHeight(!0) : 0, a = t - r.outerHeight(!0) - u; n.height(t), s.height(a), typeof frameSettings.detailResize == "function" && frameSettings.detailResize(e, a, s) } function tips_init(e) { var t = $("#tips"), n = t.css("display") != "block", r = function () { t.toggle(), e.toggle(), n = !n, t.data("isHidden", n ? "1" : ""), $(window).resize() }; e.click(r), $(".btn_close", t).click(r) } function tips_resize(e, t) { var n = $("#tips .tips"), r = $(".list", n); n.width(e), n.height(t); var i = t - $(".tips-title", n).height() - (r.outerHeight(!0) - r.height()) - 1; r.height(i), typeof frameSettings.tipsResize == "function" && frameSettings.tipsResize(e, i, r) } function tips_init_list() { var e = $("#tips"), t = $(".list", e), n = jq.$.div; t.hasClass("list-1") ? $(".items", t).each(function (e, t) { var r = $(t), i = n("bg").append(n("bg_r")).append(n("bg_b")), s = n("wrapper1"), o = n("wrapper2"); r.wrapInner(o), r.wrapInner(s), $(".wrapper1", r).prepend(i) }) : t.hasClass("list-2") && t.addClass("blockTextLink") } function sidebar_init() { var e = $("#sidebar"), t = $(".trees", e).append($("<div>").addClass("tree_last")), n = $(".tree", t), r = $(".tree_last", t), i = !1; n.last().css("border-bottom-width", 0), n.each(function (e, n) { var s = $(n), o = $(".name", s), u = $(".nodes", s); o.click(function () { u.slideToggle("fast", function () { s.toggleClass("tree-expand"), t[0].scrollHeight > t.height() ? r.hide() : r.show() }), s.hasClass("tree-expand") && (u.show(), i = !0) }) }), i && (t[0].scrollHeight > t.height() ? r.hide() : r.show()) } function sidebar_resize(e, t) { var n = $("#sidebar"), r = $(".title", n), i = $(".datacenter", n), s = $(".trees", n), o = t; o -= r.outerHeight(!0), o -= i.outerHeight(!0), n.height(t), s.height(o); var u = $(".tree_last", s); s[0].scrollHeight > o ? u.hide() : u.show(), typeof frameSettings.sidebarResize == "function" && frameSettings.sidebarResize(e, o, trees) } function ie6_init() { var e = $(document.body).addClass("ie6_size"), t = $("#quickbar"), n = $("#ie6"), r = $("#ie6_tips"), i = $("<div>").attr("id", "ie6_tester").addClass("ie6_size"), s = $("<div>").attr("id", "ie6_wrapper").append(t).append(n).append(i); e.append(s); var o = t.outerHeight(!0), u = r.outerWidth(!0), a = r.outerHeight(!0), f = 110 / (760 - a), l = function () { s.width(u < e.width() ? e.width() : u), s.height("auto"); var t = i.height(); t > a && s.height(t); var n = s.height() - o - a; r.css("top", n * f) }; l(), $(window).resize(l), quickbar_init(!0) } function getScrollbarWidth() { var e = 60, t = e * .75, n = $("<div>").css({ position: "absolute", width: e, height: t, overflow: "auto", top: 0, left: 0, zIndex: -1 }).append("<div>"); $(document.body).append(n); var r = $("div", n).height(e), i = e - r.width(); return n.remove(), i } function fixUsername() { var e = 10, t = $("#contentNav"), n = $(".nav", t), r = $(".item:first-child .t", n), i = r.text(), s = "", o = 0, u = 0; while (u < i.length) { var a = i.charAt(u++), f = a.charCodeAt(); if (f < 128) s += a, o++; else { if (o >= e - 1) { u--; break } s += a, o += 2 } if (o >= e) break } u < i.length && (s += "..."), r.text(s) } $(frameInit); var frameSettings = { autoInit: !0, mainResize: null, detailResize: null, tipsResize: null, sidebarResize: null, mainMinWidth: -1, mainMinHeight: -1, detailMinHeight: -1, tipsMinWidth: -1 }